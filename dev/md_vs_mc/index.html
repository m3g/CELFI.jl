<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparando MD y MC · FundamentosDMC.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FundamentosDMC.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FundamentosDMC.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Início</a></li><li><a class="tocitem" href="../sistema/">Sistema simulado</a></li><li><a class="tocitem" href="../simple/">Simulación microcanónica</a></li><li><a class="tocitem" href="../isokinetic/">Termostato isocinético</a></li><li><a class="tocitem" href="../berendsen/">Termostato de Berendsen</a></li><li><a class="tocitem" href="../langevin/">Termostato de Langevin</a></li><li><a class="tocitem" href="../montecarlo/">Monte-Carlo</a></li><li class="is-active"><a class="tocitem" href>Comparando MD y MC</a><ul class="internal"><li><a class="tocitem" href="#.1.-Generando-un-buen-muestreo-por-MD"><span>8.1. Generando un buen muestreo por MD</span></a></li><li><a class="tocitem" href="#.2.-Generando-un-buen-muestreo-de-MC"><span>8.2. Generando un buen muestreo de MC</span></a></li><li><a class="tocitem" href="#.3.-Comparando-las-energías-potenciales"><span>8.3. Comparando las energías potenciales</span></a></li><li><a class="tocitem" href="#.4.-Función-de-distribución-radial"><span>8.4. Función de distribución radial</span></a></li><li><a class="tocitem" href="#.5.-Cálculo-de-g(r)"><span>8.5. Cálculo de <span>$g(r)$</span></span></a></li><li><a class="tocitem" href="#.2.-Código-completo-resumido"><span>8.2. Código completo resumido</span></a></li></ul></li><li><a class="tocitem" href="../running3D/">Ejecución en 3D</a></li><li><a class="tocitem" href="../velocities/">Distribución de velocidades</a></li><li><a class="tocitem" href="../help/">Help entries</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Comparando MD y MC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparando MD y MC</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/FundamentosDMC.jl/blob/master/docs/src/md_vs_mc.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparación-entre-MC-y-MD"><a class="docs-heading-anchor" href="#Comparación-entre-MC-y-MD">Comparación entre MC y MD</a><a id="Comparación-entre-MC-y-MD-1"></a><a class="docs-heading-anchor-permalink" href="#Comparación-entre-MC-y-MD" title="Permalink"></a></h1><p>Vamos a comparar el conjunto de estructuras generados por una dinámica molecular con un conjunto de estructuras generado por una simulación de Monte-Carlo. </p><h2 id=".1.-Generando-un-buen-muestreo-por-MD"><a class="docs-heading-anchor" href="#.1.-Generando-un-buen-muestreo-por-MD">8.1. Generando un buen muestreo por MD</a><a id=".1.-Generando-un-buen-muestreo-por-MD-1"></a><a class="docs-heading-anchor-permalink" href="#.1.-Generando-un-buen-muestreo-por-MD" title="Permalink"></a></h2><p>Ejecute, nuevamente, el programa <code>md_langevin</code> con los parámetros <span>$\lambda=0.01$</span>, por 100 mil pasos, y salve la trayectoria en un archivo con nombre propio, como <code>md.xyz</code>: </p><pre><code class="language-julia-repl hljs">julia&gt; md_out = md_langevin(
           sys,
           Options(lambda=0.01,nsteps=100_000,trajectory_file=&quot;md.xyz&quot;)
       );</code></pre><h2 id=".2.-Generando-un-buen-muestreo-de-MC"><a class="docs-heading-anchor" href="#.2.-Generando-un-buen-muestreo-de-MC">8.2. Generando un buen muestreo de MC</a><a id=".2.-Generando-un-buen-muestreo-de-MC-1"></a><a class="docs-heading-anchor-permalink" href="#.2.-Generando-un-buen-muestreo-de-MC" title="Permalink"></a></h2><p>Ejecute una larga simulación de Monte-Carlo (<code>300_000</code> pasos)</p><pre><code class="language-julia-repl hljs">julia&gt; mc_out = mc(
           sys,
           Options(alpha=0.05,nsteps=300_000,trajectory_file=&quot;mc.xyz&quot;)
       );</code></pre><h2 id=".3.-Comparando-las-energías-potenciales"><a class="docs-heading-anchor" href="#.3.-Comparando-las-energías-potenciales">8.3. Comparando las energías potenciales</a><a id=".3.-Comparando-las-energías-potenciales-1"></a><a class="docs-heading-anchor-permalink" href="#.3.-Comparando-las-energías-potenciales" title="Permalink"></a></h2><p>La primera columna de <code>md_out</code> tiene la energía potencial en la simulación de dinámica molecular. Vamos a hacer el gráfico de esta energía:</p><pre><code class="language-julia-repl hljs">julia&gt; plot(md_out[:,1],label=&quot;Potential energy- MD&quot;,xlabel=&quot;step&quot;)</code></pre><p>Y vamos a añadir al mismo gráfico la energía potencial obtenida en la simulación de Monte-Carlo, que está en <code>mc_out</code> (note el <code>!</code> al final de <code>plot!</code>, indicando que el gráfico anterior va a ser modificado):</p><pre><code class="language-julia-repl hljs">julia&gt; plot!(mc_out,label=&quot;Potential energy- MC&quot;,xlabel=&quot;step&quot;)</code></pre><p>Note la similaridad, o diferencia entre los dos gráficos. Acuerde-se que en ninguna de estas simulaciones controlamos explícitamente la energía potencial. </p><h2 id=".4.-Función-de-distribución-radial"><a class="docs-heading-anchor" href="#.4.-Función-de-distribución-radial">8.4. Función de distribución radial</a><a id=".4.-Función-de-distribución-radial-1"></a><a class="docs-heading-anchor-permalink" href="#.4.-Función-de-distribución-radial" title="Permalink"></a></h2><p>Vamos a comparar la estructura media obtenida usando MD con la estructura media obtenida con MC. Para eso vamos a usar la función <span>$g(r)$</span>, que se llama ``función de distribución radial&#39;&#39;.  Esta función mide la probabilidad de encontrar una partícula a una distancia <span>$r$</span> de otra partícula en el sistema real, en relación a esa misma probabilidad si no hubiese ninguna interacción entre las partículas. </p><p>En nuestro caso bi-dimensional, el número de partículas por unidad de volumen es <span>$\rho=n/A$</span>, donde <span>$n=100$</span> es el número de partículas y <span>$A=100^2$</span> es el área total del sistema simulado. El número de partículas esperado en un intervalo de distancias entre <span>$r$</span> y <span>$r+\Delta r$</span> de cada partícula es, por lo tanto <span>$n(r)=\rho A(r)$</span>, donde <span>$A(r)$</span> es el área de una cáscara circular de radio menor <span>$r$</span> y radio mayor <span>$r+\Delta r$</span>:</p><center>
<img src=../figures/area.svg>
</center><p>Vemos que <span>$A(r)=\pi (r+\Delta r)^2 - \pi r^2 \approx 2\pi r\Delta r$</span>. De este modo, el número de partículas esperado, en media, seria de  <span>$n(r)=2\pi r\Delta r\rho$</span>, si no hubiese interacciones. </p><p>Las interacciones hacen con que el número de partículas en cada distancia sea diferente de una distribución homogénea. Si hay interacciones favorables, por ejemplo, la probabilidad de encontrar dos partículas próximas es mayor. Esta distribución de partículas es uno de los parámetros estructurales más importantes.</p><h2 id=".5.-Cálculo-de-g(r)"><a class="docs-heading-anchor" href="#.5.-Cálculo-de-g(r)">8.5. Cálculo de <span>$g(r)$</span></a><a id=".5.-Cálculo-de-g(r)-1"></a><a class="docs-heading-anchor-permalink" href="#.5.-Cálculo-de-g(r)" title="Permalink"></a></h2><p>El programa <a href="https://github.com/m3g/FUndamentosDMC.jl/blob/master/src/radial_distribution.jl">radial_distribution.jl</a>   calcula, a partir de una trayectoria, la función <span>$g(r)=n&#39;(r)/n(r)$</span>, done <span>$n(r)$</span> esta definido anteriormente, y <span>$n&#39;(r)$</span> es el número medio de partículas efectivamente observado entre <span>$r$</span> y <span>$r+\Delta r$</span> en la simulación. </p><p>Para calcular la función de distribución radial de la simulación de dinámica molecular, ejecute:</p><pre><code class="language-julia-repl hljs">julia&gt; rmd, gmd = radial_distribution(sys,&quot;md.xyz&quot;)</code></pre><p><code>rmc</code> y <code>rmd</code> son las distancias y las densidades relativas de partículas a cada distancia, en relación a la densidad del sistema. </p><p>En seguida, obtengamos la <span>$g(r)$</span> de la simulación de Monte-Carlo: </p><pre><code class="language-julia-repl hljs">julia&gt; rmc, gmc = radial_distribution(sys,&quot;mc.xyz&quot;)</code></pre><p>Cree en gráfico de la función de distribución de la simulación de dinámica molecular, con:</p><pre><code class="language-julia-repl hljs">julia&gt; plot(rmd,gmd,xlabel=&quot;r&quot;,ylabel=&quot;g(r)&quot;,label=&quot;MD&quot;)</code></pre><p>Note el aumento de densidad local en distancias cortas, que resulta de las interacciones favorables entre las partículas. Note también que la densidad relativa tiende a <code>1.0</code> en distancias grandes, cuando la correlación de la posición entre partículas no és mas importante.  </p><p>Agregue al mismo gráfico la función de distribución obtenida a partir de la simulación de Monte-Carlo:  </p><pre><code class="language-julia-repl hljs">julia&gt; plot!(rmc,gmc,xlabel=&quot;r&quot;,ylabel=&quot;g(r)&quot;,label=&quot;MC&quot;)</code></pre><p>Compare. Las simulaciones, con sus naturalezas totalmente distintas, muestrearon las mismas estructuras?  </p><h2 id=".2.-Código-completo-resumido"><a class="docs-heading-anchor" href="#.2.-Código-completo-resumido">8.2. Código completo resumido</a><a id=".2.-Código-completo-resumido-1"></a><a class="docs-heading-anchor-permalink" href="#.2.-Código-completo-resumido" title="Permalink"></a></h2><pre><code class="language-julia hljs">using FundamentosDMC, Plots
sys = System(n=100,sides=[100,100])
minimize!(sys)

md_out = md_langevin(
    sys,
    Options(lambda=0.01,nsteps=100_000,trajectory_file=&quot;md.xyz&quot;)
)
mc_out = mc(
    sys,
    Options(alpha=0.05,nsteps=300_000,trajectory_file=&quot;mc.xyz&quot;)
)
plot(md_out[:,1],label=&quot;Potential energy- MD&quot;,xlabel=&quot;step&quot;)
plot!(mc_out,label=&quot;Potential energy- MC&quot;,xlabel=&quot;step&quot;)
savefig(&quot;potential_energy.pdf&quot;)

rmd, gmd = radial_distribution(sys,&quot;md.xyz&quot;)
rmc, gmc = radial_distribution(sys,&quot;mc.xyz&quot;)
plot(rmd,gmd,xlabel=&quot;r&quot;,ylabel=&quot;g(r)&quot;,label=&quot;MD&quot;)
plot!(rmc,gmc,xlabel=&quot;r&quot;,ylabel=&quot;g(r)&quot;,label=&quot;MC&quot;)
savefig(&quot;gr.pdf&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../montecarlo/">« Monte-Carlo</a><a class="docs-footer-nextpage" href="../running3D/">Ejecución en 3D »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 26 July 2023 18:42">Wednesday 26 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
