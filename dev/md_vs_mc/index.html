<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparando MD y MC · CELFI.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CELFI.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Início</a></li><li><a class="tocitem" href="../sistema/">Sistema simulado</a></li><li><a class="tocitem" href="../simple/">Simulación microcanónica</a></li><li><a class="tocitem" href="../isokinetic/">Termostato isocinético</a></li><li><a class="tocitem" href="../berendsen/">Termostato de Berendsen</a></li><li><a class="tocitem" href="../langevin/">Termostato de Langevin</a></li><li><a class="tocitem" href="../montecarlo/">Monte-Carlo</a></li><li class="is-active"><a class="tocitem" href>Comparando MD y MC</a><ul class="internal"><li><a class="tocitem" href="#Generando-un-buen-muestreo-por-MD"><span>Generando un buen muestreo por MD</span></a></li><li><a class="tocitem" href="#Generando-un-buen-muestreo-de-MC"><span>Generando un buen muestreo de MC</span></a></li><li><a class="tocitem" href="#Función-de-distribución-radial"><span>Función de distribución radial</span></a></li><li><a class="tocitem" href="#Cálculo-de-g(r)"><span>Cálculo de <span>$g(r)$</span></span></a></li></ul></li><li><a class="tocitem" href="../help/">Help entries</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Comparando MD y MC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparando MD y MC</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/CELFI.jl/blob/master/docs/src/md_vs_mc.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparación-entre-MC-y-MD"><a class="docs-heading-anchor" href="#Comparación-entre-MC-y-MD">Comparación entre MC y MD</a><a id="Comparación-entre-MC-y-MD-1"></a><a class="docs-heading-anchor-permalink" href="#Comparación-entre-MC-y-MD" title="Permalink"></a></h1><p>Vamos a comparar el conjunto de estructuras generados por una dinámica molecular con un conjunto de estructuras generado por una simulación de Monte-Carlo. </p><h2 id="Generando-un-buen-muestreo-por-MD"><a class="docs-heading-anchor" href="#Generando-un-buen-muestreo-por-MD">Generando un buen muestreo por MD</a><a id="Generando-un-buen-muestreo-por-MD-1"></a><a class="docs-heading-anchor-permalink" href="#Generando-un-buen-muestreo-por-MD" title="Permalink"></a></h2><p>Ejecute, nuevamente, el programa <code>md_langevin</code> con los parámetros <span>$\lambda=0.01$</span>, por 40 mil pasos, y salve la trajectoria en un archivo con nombre próprio, como <code>md.xyz</code>: </p><pre><code class="language-julia-repl">julia&gt; md_out = md_langevin(
         sys,
         Options(lambda=0.01,nsteps=100_000,trajectory_file=&quot;md.xyz&quot;)
       )</code></pre><h2 id="Generando-un-buen-muestreo-de-MC"><a class="docs-heading-anchor" href="#Generando-un-buen-muestreo-de-MC">Generando un buen muestreo de MC</a><a id="Generando-un-buen-muestreo-de-MC-1"></a><a class="docs-heading-anchor-permalink" href="#Generando-un-buen-muestreo-de-MC" title="Permalink"></a></h2><p>Ejecute una larga simulación de Monte-Carlo (<code>200_000</code> pasos)</p><pre><code class="language-julia-repl">julia&gt; mc_out = mc(sys,
                  Options(alpha=0.1,nsteps=200_000,trajectory_file=&quot;mc.xyz&quot;)
       )</code></pre><p>Observe el gráfico de energías. Compare la energía {\it potencial} de este gráfico con la energía potencial de la simulación de Monte-Carlo.</p><h2 id="Función-de-distribución-radial"><a class="docs-heading-anchor" href="#Función-de-distribución-radial">Función de distribución radial</a><a id="Función-de-distribución-radial-1"></a><a class="docs-heading-anchor-permalink" href="#Función-de-distribución-radial" title="Permalink"></a></h2><p>Vamos a comparar la estructura media obtenida usando MD con la estructura media obtenida con MC. Para eso vamos a usar la función <span>$g(r)$</span>, que se llama ``función de distribución radial&#39;&#39;.  Esta función mide la probabilidad de encontrar una partícula a una distancia <span>$r$</span> de otra partícula en el sistema real, en relación a esa misma probabilidad si no hubiese ninguna interacción entre las partículas. </p><p>En nuestro caso bi-dimensional, el número de partículas por unidad de volumen es <span>$\rho=n/A$</span>, donde <span>$n=100$</span> es el número de partículas y <span>$A=100^2$</span> es el área total del sistema simulado. El número de partículas esperado en un intervalo de distancias entre <span>$r$</span> y <span>$r+\Delta r$</span> de cada partícula es, por lo tanto <span>$n(r)=\rho A(r)$</span>, donde <span>$A(r)$</span> es el área de una cáscara circular de radio menor <span>$r$</span> y radio mayor <span>$r+\Delta r$</span>:</p><center>
<img src=../figures/area.svg>
</center><p>Vemos que <span>$A(r)=\pi (r+\Delta r)^2 - \pi r^2 \approx 2\pi r\Delta r$</span>. De este modo, el número de partículas esperado, en media, seria de  <span>$n(r)=2\pi r\Delta r\rho$</span>, si no hubiese interacciones. </p><p>Las interacciones hacen con que el número de partículas en cada distancia sea diferente de una distribución homogénea. Si hay interacciones favorables, por ejemplo, la probabilidad de encontrar dos partículas próximas es mayor. Esta distribución de partículas es uno de los parámetros estructurales más importantes.</p><h2 id="Cálculo-de-g(r)"><a class="docs-heading-anchor" href="#Cálculo-de-g(r)">Cálculo de <span>$g(r)$</span></a><a id="Cálculo-de-g(r)-1"></a><a class="docs-heading-anchor-permalink" href="#Cálculo-de-g(r)" title="Permalink"></a></h2><p>El programa <a href="https://github.com/m3g/CELFI.jl/blob/master/src/radial_distribution.jl">radial_distribution.jl</a>   calcula, a partir de una trayectoria, la función <span>$g(r)=n&#39;(r)/n(r)$</span>, done <span>$n(r)$</span> esta definido anteriormente, y <span>$n&#39;(r)$</span> es el número medio de partículas efectivamente observado entre <span>$r$</span> y <span>$r+\Delta r$</span> en la simulación. </p><p>Haga una simulación de dinámica molecular con el termostato de Langevin, ahora por más tiempo,  usando el comando  \command{./bin/md-langevin 15000} Use los parámetros <span>$\lambda=0.01$</span> y <span>$\Delta t=0.05$</span>. Observe la trayectoria resultante y calcule al función <span>$g(r)$</span> simplemente ejecutando el program <code>radial_distribution</code>. En seguida, visualice el <span>$g(r)$</span> con \command{xmgrace gr.dat}  Mantenga este gráfico abierto, para comparación futura. Entienda que significa, en función de la visualización de la simulación. </p><p>En seguida, haga una simulación de 200.000 pasos de Monte-Carlo con el programa  {\tt bin/mc} usando una perturbación de 0.05~\AA. Observe la trayectoria generada. Ejecute nuevamente el programa {\tt bin/gr} para obtener la <span>$g(r)$</span> de esta simulación de Monte-Carlo. Incorpore los datos al mismo gráfico del <span>$g(r)$</span> obtenido por dinámica molecular. Compare. Las simulaciones, con sus naturalezas totalmente distintas, muestrearon las mismas estructuras?  </p><p>\end{document}</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../montecarlo/">« Monte-Carlo</a><a class="docs-footer-nextpage" href="../help/">Help entries »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Friday 9 July 2021 20:25">Friday 9 July 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
